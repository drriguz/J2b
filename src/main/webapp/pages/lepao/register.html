@var css={
<link href="${CONTEXT_PATH}/static/bootstrap-switch/css/bootstrap3/bootstrap-switch.min.css" rel="stylesheet" />
<link href="${CONTEXT_PATH}/static/bootstrap-tagsinput/bootstrap-tagsinput.css" rel="stylesheet" />
<link href='${CONTEXT_PATH}/static/bower/sco.js/css/scojs.css' rel='stylesheet'>
<link href='${CONTEXT_PATH}/static/bower/sco.js/css/sco.message.css' rel='stylesheet'>
@};

@var js={
<script src="${CONTEXT_PATH}/static/bootstrap-switch/js/bootstrap-switch.min.js"></script>
<script src="${CONTEXT_PATH}/static/bootstrap-tagsinput/bootstrap-tagsinput.min.js"></script>
<script src="${CONTEXT_PATH}/static/bower/sco.js/js/sco.modal.js"></script>
<script src="${CONTEXT_PATH}/static/bower/sco.js/js/sco.confirm.js"></script>
<script src="${CONTEXT_PATH}/static/bower/sco.js/js/sco.message.js"></script>

<script>
	$(function(){
		$(".switch").bootstrapSwitch();
	});
	function doRegister(){
		$("#registerForm").validate({
		}).form();
		if (!$("#registerForm").valid())
			return;
		var formData = $("#registerForm").serialize();
		var url = $("#registerForm").attr('action');
		$.ajax({
			type:'post',
			url:url,
			data:formData,
			cache:false,
			dataType:'json',
			success:function(data){
				var error = data.error;
				if(error == '0'){
					$('.modal').modal('hide')
					$.scojs_message('操作成功！', $.scojs_message.TYPE_OK);
					setTimeout(function(){
						$(window.location).attr('href', '/lepao/home?open_id=' + $("input[name$=OPEN_ID]").val());
					},1000); 
				}
				else
					alert('错误：' + data.data);
			}
		});
	}
</script>
@};

@layout("../../layout/_mobileLayout.html", {title:"完善个人信息", js:js,head:css}){	
    <div class="container">
    	<div class="row header">
    	</div>
    	<hr>
    	<form method="post" action="/lepao/doRegister" id="registerForm" class="form-horizontal" user="form">
			<input type="hidden" name="user.OPEN_ID" value="${open_id!}"/>
			<tp:inlineField id="userName" label="姓名" name="user.REAL_NAME" required="true"/>
			<tp:switchField id="userGender" label="性别" name="GENDER" required="true" on="男" off="女" checked="true"/>
			<tp:inlineField id="userNumber" label="号码布" name="user.LEPAO_NUMBER" required="true" />
			<tp:inlineField id="userMobile" label="微信号" name="user.MOBILE" required="false" desc="填写您的微信号让别人联系到您"/>
			<tp:inlineField id="userSays" label="想对他/她说" name="user.SAYS" required="false" desc="填写您的交友宣言"/>
			<tp:inlineField id="userHobbits" label="爱好" name="user.HOBBY" required="false" type="data-role='tagsinput'" desc="填写兴趣爱好匹配将更准"/>
			<div class="labels" style="margin-bottom:15px;">
				<span class="tag-label">运动</span>
				<span class="tag-label">音乐</span>
				<span class="tag-label">电影</span>
				<span class="tag-label">读书</span>
				<span class="tag-label">美食</span>
				<span class="tag-label">网购</span>
			</div>
	        <div class="row form-item pay">
                <div class="col-xs-12 pay-button" style="text-align:center;">
	                <button type="button" class="btn btn-success" onclick="doRegister()" style="width:100px;">完成</button>
	            </div>
	        </div>
        </form>
    </nav>
    </div>
@}